<script>
document.addEventListener("DOMContentLoaded", () => {

  async function carregarDadosRemotos() {
    const url = "https://script.google.com/macros/s/AKfycbwMqkBnU09-kXvW0tmtXVgHckY1sXMg6gJOqKWB3cQdcIOuLVXC_TwMvi_Oo-OawngqQw/exec";
    
    try {
      const resposta = await fetch(url);
      const dados = await resposta.json();
      console.log("✅ Dados recebidos:", dados);

      // Pega o último registro
      const ultimo = dados[dados.length - 1];

      // Atualiza elementos no painel, só se existirem
      const tempEl = document.getElementById("temp");
      if(tempEl) tempEl.innerText = ultimo.Temperatura + " °C";

      const umidEl = document.getElementById("umid");
      if(umidEl) umidEl.innerText = ultimo.Umidade + " %";

      const ventoEl = document.getElementById("vento");
      if(ventoEl) ventoEl.innerText = ultimo.VelocidadeVento + " km/h";

      const chuvaEl = document.getElementById("chuva");
      if(chuvaEl) chuvaEl.innerText = ultimo.Pluviometria + " mm";

      const dataEl = document.getElementById("dataAtual");
      if(dataEl) dataEl.innerText = ultimo.Data + " " + ultimo.Hora;

    } catch (erro) {
      console.error("❌ Erro ao carregar dados:", erro);
    }
  }

  // Atualiza ao carregar a página
  carregarDadosRemotos();

  // Atualiza a cada 10 minutos
  setInterval(carregarDadosRemotos, 10 * 60 * 1000);

});
</script>
